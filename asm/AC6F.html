<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>The Great Escape: Routine at AC6F</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="../skoolkit.css" />
<link rel="stylesheet" type="text/css" href="../TheGreatEscape.css" />

</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a class="link" href="../index.html"><img alt="logo" src="../images/logo.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev"><span class="prev-1">Prev: <a class="link" href="ABF9.html">ABF9</a></span></td>
<td class="up">Up: <a class="link" href="../maps/all.html#ac6f">Map</a></td>
<td class="next"><span class="next-1">Next: <a class="link" href="ACFC.html">ACFC</a></span></td>
</tr>
</table>
<div class="description">AC6F: Draw zoombox border.</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="4">
<div class="details">
<div class="paragraph">
Used by the routine at <a class="link" href="ABA0.html">ABA0</a>.
</div>
</div>
<table class="input-0">
<tr class="asm-input-header">
<th colspan="2">Input</th>
</tr>

</table>
<table class="output-0">
<tr class="asm-output-header">
<th colspan="2">Output</th>
</tr>

</table>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><a name="ac6f"></a>AC6F</td>
<td class="instruction">LD A,($AB68)</td>
<td class="comment-11" rowspan="15">HL = game_window_start_addresses[(zoombox_y - 1) * 8]; // ie. * 16</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="ac72"></a>AC72</td>
<td class="instruction">DEC A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="ac73"></a>AC73</td>
<td class="instruction">ADD A,A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="ac74"></a>AC74</td>
<td class="instruction">ADD A,A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="ac75"></a>AC75</td>
<td class="instruction">ADD A,A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="ac76"></a>AC76</td>
<td class="instruction">ADD A,A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="ac77"></a>AC77</td>
<td class="instruction">LD HL,$EDD3</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="ac7a"></a>AC7A</td>
<td class="instruction">ADD A,L</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="ac7b"></a>AC7B</td>
<td class="instruction">LD L,A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="ac7c"></a>AC7C</td>
<td class="instruction">JR NC,$AC7F</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="ac7e"></a>AC7E</td>
<td class="instruction">INC H</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><a name="ac7f"></a>AC7F</td>
<td class="instruction">LD A,(HL)</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="ac80"></a>AC80</td>
<td class="instruction">INC HL</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="ac81"></a>AC81</td>
<td class="instruction">LD H,(HL)</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="ac82"></a>AC82</td>
<td class="instruction">LD L,A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="routine-comment" colspan="4">
<a name="ac83"></a>
<div class="comments">
<div class="paragraph">
Top left.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="ac83"></a>AC83</td>
<td class="instruction">LD A,($AB66)</td>
<td class="comment-11" rowspan="4">HL += zoombox_x - 1;</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="ac86"></a>AC86</td>
<td class="instruction">DEC A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="ac87"></a>AC87</td>
<td class="instruction">ADD A,L</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="ac88"></a>AC88</td>
<td class="instruction">LD L,A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="ac89"></a>AC89</td>
<td class="instruction">LD A,$00</td>
<td class="comment-11" rowspan="2">zoombox_draw_tile(zoombox_tile_TL);</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="ac8b"></a>AC8B</td>
<td class="instruction">CALL <a class="link" href="ACFC.html">$ACFC</a></td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="ac8e"></a>AC8E</td>
<td class="instruction">INC L</td>
<td class="comment-11" rowspan="1">HL++;</td>
</tr>
<tr>
<td class="routine-comment" colspan="4">
<a name="ac8f"></a>
<div class="comments">
<div class="paragraph">
Horizontal, moving right.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="ac8f"></a>AC8F</td>
<td class="instruction">LD A,($AB67)</td>
<td class="comment-11" rowspan="2">B = zoombox_horizontal_count; // iterations</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="ac92"></a>AC92</td>
<td class="instruction">LD B,A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><a name="ac93"></a>AC93</td>
<td class="instruction">LD A,$01</td>
<td class="comment-11" rowspan="2">do &lt;% zoombox_draw_tile(zoombox_tile_HZ);</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="ac95"></a>AC95</td>
<td class="instruction">CALL <a class="link" href="ACFC.html">$ACFC</a></td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="ac98"></a>AC98</td>
<td class="instruction">INC L</td>
<td class="comment-11" rowspan="1">HL++;</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="ac99"></a>AC99</td>
<td class="instruction">DJNZ $AC93</td>
<td class="comment-11" rowspan="1">%&gt; while (--B);</td>
</tr>
<tr>
<td class="routine-comment" colspan="4">
<a name="ac9b"></a>
<div class="comments">
<div class="paragraph">
Top right.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="ac9b"></a>AC9B</td>
<td class="instruction">LD A,$02</td>
<td class="comment-11" rowspan="2">zoombox_draw_tile(zoombox_tile_TR);</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="ac9d"></a>AC9D</td>
<td class="instruction">CALL <a class="link" href="ACFC.html">$ACFC</a></td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="aca0"></a>ACA0</td>
<td class="instruction">LD DE,$0020</td>
<td class="comment-11" rowspan="1">DE = 32;</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="aca3"></a>ACA3</td>
<td class="instruction">LD A,L</td>
<td class="comment-11" rowspan="4">if (L &gt;= 224) D = 0x07;</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="aca4"></a>ACA4</td>
<td class="instruction">CP $E0</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="aca6"></a>ACA6</td>
<td class="instruction">JR C,$ACAA</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="aca8"></a>ACA8</td>
<td class="instruction">LD D,$07</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><a name="acaa"></a>ACAA</td>
<td class="instruction">ADD HL,DE</td>
<td class="comment-11" rowspan="1">HL += DE;</td>
</tr>
<tr>
<td class="routine-comment" colspan="4">
<a name="acab"></a>
<div class="comments">
<div class="paragraph">
Vertical, moving down.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="acab"></a>ACAB</td>
<td class="instruction">LD A,($AB69)</td>
<td class="comment-11" rowspan="2">B = zoombox_vertical_count; // iterations</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="acae"></a>ACAE</td>
<td class="instruction">LD B,A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><a name="acaf"></a>ACAF</td>
<td class="instruction">LD A,$03</td>
<td class="comment-11" rowspan="2">do &lt;% zoombox_draw_tile(zoombox_tile_VT);</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="acb1"></a>ACB1</td>
<td class="instruction">CALL <a class="link" href="ACFC.html">$ACFC</a></td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="acb4"></a>ACB4</td>
<td class="instruction">LD DE,$0020</td>
<td class="comment-11" rowspan="1">DE = 32;</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="acb7"></a>ACB7</td>
<td class="instruction">LD A,L</td>
<td class="comment-11" rowspan="4">if (L &gt;= 224) D = 0x07;</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="acb8"></a>ACB8</td>
<td class="instruction">CP $E0</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="acba"></a>ACBA</td>
<td class="instruction">JR C,$ACBE</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="acbc"></a>ACBC</td>
<td class="instruction">LD D,$07</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><a name="acbe"></a>ACBE</td>
<td class="instruction">ADD HL,DE</td>
<td class="comment-11" rowspan="1">HL += DE;</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="acbf"></a>ACBF</td>
<td class="instruction">DJNZ $ACAF</td>
<td class="comment-11" rowspan="1">%&gt; while (--B);</td>
</tr>
<tr>
<td class="routine-comment" colspan="4">
<a name="acc1"></a>
<div class="comments">
<div class="paragraph">
Bottom right.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="acc1"></a>ACC1</td>
<td class="instruction">LD A,$04</td>
<td class="comment-11" rowspan="2">zoombox_draw_tile(zoombox_tile_BR);</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="acc3"></a>ACC3</td>
<td class="instruction">CALL <a class="link" href="ACFC.html">$ACFC</a></td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="acc6"></a>ACC6</td>
<td class="instruction">DEC L</td>
<td class="comment-11" rowspan="1">HL--;</td>
</tr>
<tr>
<td class="routine-comment" colspan="4">
<a name="acc7"></a>
<div class="comments">
<div class="paragraph">
Horizontal, moving left.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="acc7"></a>ACC7</td>
<td class="instruction">LD A,($AB67)</td>
<td class="comment-11" rowspan="2">B = zoombox_horizontal_count; // iterations</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="acca"></a>ACCA</td>
<td class="instruction">LD B,A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><a name="accb"></a>ACCB</td>
<td class="instruction">LD A,$01</td>
<td class="comment-11" rowspan="2">do &lt;% zoombox_draw_tile(zoombox_tile_HZ);</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="accd"></a>ACCD</td>
<td class="instruction">CALL <a class="link" href="ACFC.html">$ACFC</a></td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="acd0"></a>ACD0</td>
<td class="instruction">DEC L</td>
<td class="comment-11" rowspan="1">HL--;</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="acd1"></a>ACD1</td>
<td class="instruction">DJNZ $ACCB</td>
<td class="comment-11" rowspan="1">%&gt; while (--B);</td>
</tr>
<tr>
<td class="routine-comment" colspan="4">
<a name="acd3"></a>
<div class="comments">
<div class="paragraph">
Bottom left.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="acd3"></a>ACD3</td>
<td class="instruction">LD A,$05</td>
<td class="comment-11" rowspan="2">zoombox_draw_tile(zoombox_tile_BL);</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="acd5"></a>ACD5</td>
<td class="instruction">CALL <a class="link" href="ACFC.html">$ACFC</a></td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="acd8"></a>ACD8</td>
<td class="instruction">LD DE,$FFE0</td>
<td class="comment-11" rowspan="1">DE = 0xFFE0;</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="acdb"></a>ACDB</td>
<td class="instruction">LD A,L</td>
<td class="comment-11" rowspan="4">if (L &lt; 32) DE = 0xF8E0;</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="acdc"></a>ACDC</td>
<td class="instruction">CP $20</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="acde"></a>ACDE</td>
<td class="instruction">JR NC,$ACE3</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="ace0"></a>ACE0</td>
<td class="instruction">LD DE,$F8E0</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><a name="ace3"></a>ACE3</td>
<td class="instruction">ADD HL,DE</td>
<td class="comment-11" rowspan="1">HL += DE;</td>
</tr>
<tr>
<td class="routine-comment" colspan="4">
<a name="ace4"></a>
<div class="comments">
<div class="paragraph">
Vertical, moving up.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="ace4"></a>ACE4</td>
<td class="instruction">LD A,($AB69)</td>
<td class="comment-11" rowspan="2">B = zoombox_vertical_count; // iterations</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="ace7"></a>ACE7</td>
<td class="instruction">LD B,A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><a name="ace8"></a>ACE8</td>
<td class="instruction">LD A,$03</td>
<td class="comment-11" rowspan="2">do &lt;% zoombox_draw_tile(zoombox_tile_VT);</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="acea"></a>ACEA</td>
<td class="instruction">CALL <a class="link" href="ACFC.html">$ACFC</a></td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="aced"></a>ACED</td>
<td class="instruction">LD DE,$FFE0</td>
<td class="comment-11" rowspan="1">DE = 0xFFE0;</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="acf0"></a>ACF0</td>
<td class="instruction">LD A,L</td>
<td class="comment-11" rowspan="4">if (L &lt; 32) DE = 0xF8E0;</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="acf1"></a>ACF1</td>
<td class="instruction">CP $20</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="acf3"></a>ACF3</td>
<td class="instruction">JR NC,$ACF8</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="acf5"></a>ACF5</td>
<td class="instruction">LD DE,$F8E0</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><a name="acf8"></a>ACF8</td>
<td class="instruction">ADD HL,DE</td>
<td class="comment-11" rowspan="1">HL += DE;</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="acf9"></a>ACF9</td>
<td class="instruction">DJNZ $ACE8</td>
<td class="comment-11" rowspan="1">%&gt; while (--B);</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="acfb"></a>ACFB</td>
<td class="instruction">RET</td>
<td class="comment-11" rowspan="1">return;</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev"><span class="prev-1">Prev: <a class="link" href="ABF9.html">ABF9</a></span></td>
<td class="up">Up: <a class="link" href="../maps/all.html#ac6f">Map</a></td>
<td class="next"><span class="next-1">Next: <a class="link" href="ACFC.html">ACFC</a></span></td>
</tr>
</table>
<div class="footer">
<div class="release">The incomplete The Great Escape disassembly 20150622</div>
<div class="copyright">&copy; Denton Designs. Ocean. David Thomas.</div>
<div class="created">Created using <a class="link" href="http://skoolkit.ca/">SkoolKit</a> 4.4.</div>
</div>
</body>
</html>