<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>The Great Escape: Routine at B14C</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="../skoolkit.css" />
<link rel="stylesheet" type="text/css" href="../TheGreatEscape.css" />

</head>
<body class="Asm-c">
<table class="header">
<tr>
<td class="logo"><a class="link" href="../index.html"><img alt="logo" src="../images/logo.png" /></a></td>
<td class="page-header">Routines</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev"><span class="prev-1">Prev: <a class="link" href="45319.html">B107</a></span></td>
<td class="up">Up: <a class="link" href="../maps/all.html#45388">Map</a></td>
<td class="next"><span class="next-1">Next: <a class="link" href="45511.html">B1C7</a></span></td>
</tr>
</table>
<div class="description">B14C: bounds_check</div>
<table class="disassembly">
<tr>
<td class="routine-comment" colspan="4">
<div class="details">
<div class="paragraph">
Used by the routines at <a class="link" href="44943.html">AF8F</a> and <a class="link" href="50400.html">C4E0</a>.
</div>
<div class="paragraph">
Outdoor bounds detection?
</div>
</div>
<table class="input-1">
<tr class="asm-input-header">
<th colspan="2">Input</th>
</tr>
<tr>
<td class="register">IY</td>
<td class="register-desc">Pointer to visible character block.</td>
</tr>
</table>
<table class="output-0">
<tr class="asm-output-header">
<th colspan="2">Output</th>
</tr>

</table>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><a name="45388"></a>B14C</td>
<td class="instruction">LD A,($68A0)</td>
<td class="comment-11" rowspan="3">if (room_index) &lt;% interior_bounds_check(); return; %&gt;</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45391"></a>B14F</td>
<td class="instruction">AND A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45392"></a>B150</td>
<td class="instruction">JP NZ,<a class="link" href="45727.html">$B29F</a></td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45395"></a>B153</td>
<td class="instruction">LD B,$18</td>
<td class="comment-11" rowspan="1">B = 24; // 24 iterations (includes walls and fences)</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45397"></a>B155</td>
<td class="instruction">LD DE,$B53E</td>
<td class="comment-11" rowspan="1">DE = &amp;walls[0];</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><a name="45400"></a>B158</td>
<td class="instruction">PUSH BC</td>
<td class="comment-11" rowspan="1">do &lt;% -</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45401"></a>B159</td>
<td class="instruction">PUSH DE</td>
<td class="comment-11" rowspan="1">-</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45402"></a>B15A</td>
<td class="instruction">LD A,(DE)</td>
<td class="comment-11" rowspan="2">-</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45403"></a>B15B</td>
<td class="instruction">CALL <a class="link" href="45511.html">$B1C7</a></td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45406"></a>B15E</td>
<td class="instruction">INC BC</td>
<td class="comment-11" rowspan="5">if ((saved_y &gt;= DE[0] * 8 + 2) &amp;&amp;</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45407"></a>B15F</td>
<td class="instruction">INC BC</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45408"></a>B160</td>
<td class="instruction">LD HL,($81A4)</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45411"></a>B163</td>
<td class="instruction">SBC HL,BC</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45413"></a>B165</td>
<td class="instruction">JR C,$B1BA</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45415"></a>B167</td>
<td class="instruction">INC DE</td>
<td class="comment-11" rowspan="3">-</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45416"></a>B168</td>
<td class="instruction">LD A,(DE)</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45417"></a>B169</td>
<td class="instruction">CALL <a class="link" href="45511.html">$B1C7</a></td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45420"></a>B16C</td>
<td class="instruction">INC BC</td>
<td class="comment-11" rowspan="7">(saved_y &lt;  DE[1] * 8 + 4) &amp;&amp;</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45421"></a>B16D</td>
<td class="instruction">INC BC</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45422"></a>B16E</td>
<td class="instruction">INC BC</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45423"></a>B16F</td>
<td class="instruction">INC BC</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45424"></a>B170</td>
<td class="instruction">LD HL,($81A4)</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45427"></a>B173</td>
<td class="instruction">SBC HL,BC</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45429"></a>B175</td>
<td class="instruction">JR NC,$B1BA</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45431"></a>B177</td>
<td class="instruction">INC DE</td>
<td class="comment-11" rowspan="3">-</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45432"></a>B178</td>
<td class="instruction">LD A,(DE)</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45433"></a>B179</td>
<td class="instruction">CALL <a class="link" href="45511.html">$B1C7</a></td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45436"></a>B17C</td>
<td class="instruction">LD HL,($81A6)</td>
<td class="comment-11" rowspan="3">(saved_x &gt;= DE[2] * 8)     &amp;&amp;</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45439"></a>B17F</td>
<td class="instruction">SBC HL,BC</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45441"></a>B181</td>
<td class="instruction">JR C,$B1BA</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45443"></a>B183</td>
<td class="instruction">INC DE</td>
<td class="comment-11" rowspan="3">-</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45444"></a>B184</td>
<td class="instruction">LD A,(DE)</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45445"></a>B185</td>
<td class="instruction">CALL <a class="link" href="45511.html">$B1C7</a></td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45448"></a>B188</td>
<td class="instruction">INC BC</td>
<td class="comment-11" rowspan="7">(saved_x &lt;  DE[3] * 8 + 4) &amp;&amp;</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45449"></a>B189</td>
<td class="instruction">INC BC</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45450"></a>B18A</td>
<td class="instruction">INC BC</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45451"></a>B18B</td>
<td class="instruction">INC BC</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45452"></a>B18C</td>
<td class="instruction">LD HL,($81A6)</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45455"></a>B18F</td>
<td class="instruction">SBC HL,BC</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45457"></a>B191</td>
<td class="instruction">JR NC,$B1BA</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45459"></a>B193</td>
<td class="instruction">INC DE</td>
<td class="comment-11" rowspan="3">-</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45460"></a>B194</td>
<td class="instruction">LD A,(DE)</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45461"></a>B195</td>
<td class="instruction">CALL <a class="link" href="45511.html">$B1C7</a></td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45464"></a>B198</td>
<td class="instruction">LD HL,($81A8)</td>
<td class="comment-11" rowspan="3">(saved_height &gt;= DE[4] * 8)     &amp;&amp;</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45467"></a>B19B</td>
<td class="instruction">SBC HL,BC</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45469"></a>B19D</td>
<td class="instruction">JR C,$B1BA</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45471"></a>B19F</td>
<td class="instruction">INC DE</td>
<td class="comment-11" rowspan="3">-</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45472"></a>B1A0</td>
<td class="instruction">LD A,(DE)</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45473"></a>B1A1</td>
<td class="instruction">CALL <a class="link" href="45511.html">$B1C7</a></td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45476"></a>B1A4</td>
<td class="instruction">INC BC</td>
<td class="comment-11" rowspan="5">(saved_height &lt;  DE[5] * 8 + 2)) &lt;%</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45477"></a>B1A5</td>
<td class="instruction">INC BC</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45478"></a>B1A6</td>
<td class="instruction">LD HL,($81A8)</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45481"></a>B1A9</td>
<td class="instruction">SBC HL,BC</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45483"></a>B1AB</td>
<td class="instruction">JR NC,$B1BA</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="routine-comment" colspan="4">
<a name="45485"></a>
<div class="comments">
<div class="paragraph">
Found it.
</div>
</div>
</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45485"></a>B1AD</td>
<td class="instruction">POP DE</td>
<td class="comment-11" rowspan="1">-</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45486"></a>B1AE</td>
<td class="instruction">POP BC</td>
<td class="comment-11" rowspan="1">-</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45487"></a>B1AF</td>
<td class="instruction">LD A,(IY+$07)</td>
<td class="comment-11" rowspan="3">IY[7] ^= vischar_BYTE7_BIT5; // sampled IY = $80A0, $8080, $8060</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45490"></a>B1B2</td>
<td class="instruction">XOR $20</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45492"></a>B1B4</td>
<td class="instruction">LD (IY+$07),A</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45495"></a>B1B7</td>
<td class="instruction">OR $01</td>
<td class="comment-11" rowspan="1">A |= 1; // return NZ</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45497"></a>B1B9</td>
<td class="instruction">RET</td>
<td class="comment-11" rowspan="1">return; %&gt;</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-2"><a name="45498"></a>B1BA</td>
<td class="instruction">POP DE</td>
<td class="comment-11" rowspan="1">-</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45499"></a>B1BB</td>
<td class="instruction">POP BC</td>
<td class="comment-11" rowspan="1">-</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45500"></a>B1BC</td>
<td class="instruction">LD HL,$0006</td>
<td class="comment-11" rowspan="3">DE += 6;</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45503"></a>B1BF</td>
<td class="instruction">ADD HL,DE</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45504"></a>B1C0</td>
<td class="instruction">EX DE,HL</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45505"></a>B1C1</td>
<td class="instruction">DEC B</td>
<td class="comment-11" rowspan="2">%&gt; while (--B);</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45506"></a>B1C2</td>
<td class="instruction">JP NZ,$B158</td>
<td class="comment-01" rowspan="1"></td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45509"></a>B1C5</td>
<td class="instruction">AND B</td>
<td class="comment-11" rowspan="1">A &amp;= B; // return Z</td>
</tr>
<tr>
<td class="asm-label-0"></td>
<td class="address-1"><a name="45510"></a>B1C6</td>
<td class="instruction">RET</td>
<td class="comment-11" rowspan="1">return;</td>
</tr>
</table>
<table class="asm-navigation">
<tr>
<td class="prev"><span class="prev-1">Prev: <a class="link" href="45319.html">B107</a></span></td>
<td class="up">Up: <a class="link" href="../maps/all.html#45388">Map</a></td>
<td class="next"><span class="next-1">Next: <a class="link" href="45511.html">B1C7</a></span></td>
</tr>
</table>
<div class="footer">
<div class="release">The incomplete The Great Escape disassembly 20141125</div>
<div class="copyright">&copy; Denton Designs. Ocean. David Thomas.</div>
<div class="created">Created using <a class="link" href="http://skoolkit.ca/">SkoolKit</a> 4.1.1.</div>
</div>
</body>
</html>